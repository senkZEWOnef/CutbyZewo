<!DOCTYPE html>
<html>
  <head>
    <title>Job Details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      .uploaded-thumb {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
      }
      .file-icon {
        font-size: 2rem;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <h1 class="mb-4 text-center">Job Details</h1>

      <div class="card p-4 shadow mb-4">
        <h3 class="mb-3">Client: {{ job.client_name }}</h3>
        <p>
          <strong>Created:</strong> {{ job.created_at.strftime('%Y-%m-%d %H:%M')
          }}
        </p>

        <a
          href="{{ url_for('export_job_pdf', job_id=job.id) }}"
          class="btn btn-primary mb-2"
        >
          Export to PDF
        </a>
        <a
          href="{{ url_for('edit_job', job_id=job.id) }}"
          class="btn btn-warning mb-2"
        >
          Edit Job
        </a>
        <form
          action="{{ url_for('delete_job', job_id=job.id) }}"
          method="POST"
          style="display: inline-block"
          onsubmit="return confirm('Are you sure you want to delete this job?');"
        >
          <button type="submit" class="btn btn-danger mb-2">Delete Job</button>
        </form>
        <a href="{{ url_for('jobs') }}" class="btn btn-secondary mb-2"
          >Back to Jobs</a
        >
      </div>

      <div class="card p-4 shadow mb-4">
        <h4 class="mb-3">Cut Sheets</h4>
        {% if sheet_images %}
        <div class="row g-4">
          {% for img in sheet_images %}
          <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm">
              <img
                src="{{ url_for('static', filename=img) }}"
                class="card-img-top uploaded-thumb"
              />
              <div class="card-body p-2">
                <p class="card-text text-center mb-0">Sheet {{ loop.index }}</p>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <p>No cut sheets found for this job.</p>
        {% endif %}
      </div>

      <div class="card p-4 shadow mb-4">
        <h4 class="mb-3">Uploaded Files</h4>
        {% if uploaded_files %}
        <div class="row g-4">
          {% for file in uploaded_files %}
          <div class="col-md-6 col-lg-4">
            <div class="card border-0 shadow-sm p-2 text-center">
              {% if file.endswith('.png') or file.endswith('.jpg') or
              file.endswith('.jpeg') or file.endswith('.gif') %}
              <img
                src="{{ url_for('static', filename=file) }}"
                class="uploaded-thumb mb-2"
              />
              {% elif file.endswith('.pdf') %}
              <span class="file-icon text-danger mb-2">ðŸ“„</span>
              {% else %}
              <span class="file-icon text-secondary mb-2">ðŸ“Ž</span>
              {% endif %}
              <p class="mb-2">{{ file.split('/')[-1] }}</p>
              <a
                href="{{ url_for('static', filename=file) }}"
                target="_blank"
                class="btn btn-outline-primary btn-sm"
                >View</a
              >
              <a
                href="{{ url_for('static', filename=file) }}"
                download
                class="btn btn-outline-success btn-sm"
                >Download</a
              >
            </div>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <p>No uploaded files for this job.</p>
        {% endif %}
      </div>
    </div>
  </body>
</html>
